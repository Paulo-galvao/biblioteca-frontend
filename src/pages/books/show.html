<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link href="/src/output.css" rel="stylesheet" />
    <link rel="stylesheet" href="/src/css/main.css" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.13.1/font/bootstrap-icons.min.css">
    <title></title>
  </head>
  <body class="main-settings">
    <nav class="flex justify-between">
        <div>
            <a href="/index.html">ReadMore</a>
        </div>
        <div class="space-x-2">
            <a class="" href="src/pages/auth/register.html">Registrar</a>
            <a class="" href="src/pages/auth/login.html">Login</a>
        </div>
    </nav>

    <div id="books-show" class="flex flex-col items-center justify-center h-screen space-y-4">

    </div>

    <img src="" alt="">

    <script type="module" >
        import {url_api} from "/src/js/env.js"
        
        const params = new URLSearchParams(window.location.search);
        const id = params.get("id"); // id do livro
        
        show();

        async function show() {
            const booksShow = document.getElementById("books-show");
            
            
            try {
                const response = await fetch(`${url_api}/books/${id}`);
                
                console.log(response);

                if(!response.ok) {
                    booksShow.innerHTML = `<div>Nenhum resultado encontrado</div>`
                }

                const data = await response.json();
                const book = data.data[0];
                const div = document.createElement("div");

                switch (true) {
                    case book.rate >= 0 && book.rate <= 9:
                        div.innerHTML = `
                            <i class="bi bi-star"></i>
                            <i class="bi bi-star"></i>
                            <i class="bi bi-star"></i>
                            <i class="bi bi-star"></i>
                            <i class="bi bi-star"></i>
                        `;
                        break;
                    case book.rate >= 10 && book.rate <= 19:
                        div.innerHTML = `
                            <i class="bi bi-star-fill"></i>
                            <i class="bi bi-star"></i>
                            <i class="bi bi-star"></i>
                            <i class="bi bi-star"></i>
                            <i class="bi bi-star"></i>
                        `;
                        break;
                    case book.rate >= 20 && book.rate <= 29:
                        div.innerHTML = `
                            <i class="bi bi-star-fill"></i>
                            <i class="bi bi-star-fill"></i>
                            <i class="bi bi-star"></i>
                            <i class="bi bi-star"></i>
                            <i class="bi bi-star"></i>
                        `;
                        break;
                    case book.rate >= 30 && book.rate <= 39:
                        div.innerHTML = `
                            <i class="bi bi-star-fill"></i>
                            <i class="bi bi-star-fill"></i>
                            <i class="bi bi-star-fill"></i>
                            <i class="bi bi-star"></i>
                            <i class="bi bi-star"></i>
                        `;
                        break;
                    case book.rate >= 40 && book.rate <= 49:
                        div.innerHTML = `
                            <i class="bi bi-star-fill"></i>
                            <i class="bi bi-star-fill"></i>
                            <i class="bi bi-star-fill"></i>
                            <i class="bi bi-star-fill"></i>
                            <i class="bi bi-star"></i>
                        `;
                        break;
                    case book.rate == 50:
                        div.innerHTML = `
                            <i class="bi bi-star-fill"></i>
                            <i class="bi bi-star-fill"></i>
                            <i class="bi bi-star-fill"></i>
                            <i class="bi bi-star-fill"></i>
                            <i class="bi bi-star-fill"></i>
                        `;
                        break;
                    default:
                        break;
                }
                
                const card = `
                    <img
                        class="w-3xs"
                        src=${book.url_img} 
                        alt=${book.title} />
                    <div>
                        <h1 class="text-3xl ">${book.title}</h1>
                        <p>${book.written_by}</p>
                        <p>${div.innerHTML}</p>
                        <p>${book.description}</p>
                        <p>Primeira publicação: ${book.first_published.split("T")[0]}</p>
                    </div>
                `;

                booksShow.innerHTML = card;

            } catch (error) {
                console.log(error);
                
            }
        }

    </script>
    
  </body>
</html>
